<expandable-list-item
  [expanded]="screenMode !== 'mobile' || isExpanded"
  [header]="header"
  class="result-group"
  [numberOfItems]="filteredMaps.length || searchResults.length"
  [showBadge]="true"
  [allowTabFocus]="false"
>
  <div class="result-group__container" [ngClass]="{'result-group__container--mobile': screenMode === 'mobile'}">
    <ul class="result-group-list">
      @for (result of searchResults; track result; let first = $first) {
        <li class="result-group-list__list-item">
          <button
            (click)="selectSearchResult(result)"
            class="result-group__container__element search-result-group__container__element--interactive"
            [tabIndex]="first ? 0 : -1"
            searchResultIdentifier
            [text]="result.displayString"
          >
            <div class="result-group__container__element__container">
              @if (result.indexType === 'activeMapItems') {
                <div class="result-group__container__element__header result-group__container__element__text">{{ result.indexName }}</div>
              }
              <div
                class="result-group__container__element__content result-group__container__element__text"
                [innerHTML]="result.displayString | highlightSearchQuery: this.searchTerms"
              ></div>
            </div>
            <mat-divider></mat-divider>
          </button>
        </li>
      }
    </ul>
  </div>
  <div class="result-group__container" [ngClass]="{'result-group__container--mobile': screenMode === 'mobile'}">
    <ul class="result-group-list">
      @for (map of filteredMaps; track map; let first = $first) {
        <li class="result-group-list__list-item">
          <div class="result-group__container__element">
            <button
              class="result-group__container__element__map-content"
              (delayedMouseEnter)="addActiveMap(map, true)"
              [delayDurationInMs]="this.hoverDelay"
              (mouseleave)="removeTemporaryMap(map)"
              (click)="delegateClickToChild(map)"
              searchResultIdentifier
              [isMapResult]="true"
              [text]="map.printTitle"
              (addResultFromArrowNavigation)="addActiveMap(map, true)"
              (removeResultFromArrowNavigation)="removeTemporaryMap(map)"
              [attr.data-index]="filteredMaps.indexOf(map)"
              [tabIndex]="first ? 0 : -1"
            >
              @if (map.gb2Url) {
                <gb2-exit-button
                  [url]="map.gb2Url | appendMapConfigurationToUrl: mapConfigState"
                  [disableTabFocus]="true"
                ></gb2-exit-button>
              } @else {
                <button (click)="addActiveMap(map)" color="primary" data-test-id="add-active-map" mat-icon-button tabindex="-1">
                  <mat-icon>add</mat-icon>
                </button>
              }

              <img [alt]="map.title" [src]="map.icon" class="result-group__container__element__map-content__image" />
              <p
                [innerHTML]="map.title | highlightSearchQuery: this.searchTerms"
                class="result-group__container__element__map-content__title result-group__container__element__text"
                matTooltip="{{ map.title }}"
              ></p>
            </button>
            <mat-divider></mat-divider>
          </div>
        </li>
      }
    </ul>
  </div>
</expandable-list-item>
