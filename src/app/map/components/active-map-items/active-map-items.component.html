<mat-card appearance="raised" class="active-map-items">
  <mat-card-header class="active-map-items__header">
    <h2 class="active-map-items__header__title">Aktive Karten</h2>
    <p
      class="active-map-items__header__badge"
      [ngClass]="{'active-map-items__header__badge--hidden': this.activeMapItems.length === 0}"
      [matBadge]="this.activeMapItems.length"
      matBadgePosition="before"
      matBadgeSize="large"
    ></p>
    <div class="active-map-items__header__buttons">
      <button (click)="removeAllActiveMapItems()" [disabled]="activeMapItems.length === 0" mat-icon-button>
        <mat-icon>delete_outlined</mat-icon>
      </button>
      <mat-divider class="active-map-items__header__buttons__divider" [vertical]="true"></mat-divider>
      <span
        #tooltip="matTooltip"
        [matTooltipDisabled]="this.isAuthenticated && this.activeMapItems.length > 0"
        [matTooltip]="
          this.isAuthenticated && this.activeMapItems.length === 0
            ? this.favouriteHelperMessages.noMapsAdded
            : this.favouriteHelperMessages.notAuthenticated
        "
      >
        <button (click)="showFavouriteDialog()" [disabled]="activeMapItems.length === 0 || !this.isAuthenticated" mat-icon-button>
          <mat-icon>star_outlined</mat-icon>
        </button>
      </span>
      <mat-divider class="active-map-items__header__buttons__divider" [vertical]="true"></mat-divider>
      <button (click)="toggleMinimizeActiveMapItems()" mat-icon-button>
        <mat-icon [fontIcon]="isMinimized ? 'arrow_drop_down' : 'arrow_drop_up'"></mat-icon>
      </button>
    </div>
  </mat-card-header>
  <mat-accordion
    (cdkDropListDropped)="dropMapItem($event)"
    cdkDropList
    class="active-map-items__content"
    displayMode="flat"
    multi="true"
    [ngClass]="{'active-map-items__content--hidden': isMinimized || activeMapItems.length === 0}"
  >
    <ng-container
      *ngFor="
        let activeMapItem of activeMapItems;
        trackBy: trackByMapItemId;
        let isFirstActiveMapItem = first;
        let isLastActiveMapItem = last
      "
    >
      <active-map-item
        [activeMapItem]="activeMapItem"
        [isFirstActiveMapItem]="isFirstActiveMapItem"
        [isLastActiveMapItem]="isLastActiveMapItem"
        cdkDrag
        cdkDragBoundary="active-map-items"
        class="active-map-items__content__item"
      >
        <ng-container activeMapItemDragHandle>
          <!-- The CDK drag handle is not detected within a child component; therefore, it's necessary to pass it down using ng-content
               More information: https://stackoverflow.com/questions/54773383/cdkdraghandle-doesnt-work-inside-child-component
          -->
          <div class="active-map-items__content__item__drag-handle" cdkDragHandle></div>
        </ng-container>
        <div class="active-map-items__content__item--drag-placeholder" *cdkDragPlaceholder></div>
      </active-map-item>
    </ng-container>
  </mat-accordion>
</mat-card>
