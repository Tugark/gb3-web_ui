<mat-card appearance="outlined" class="map-catalogue-widget">
  <mat-card-header class="map-catalogue__header">
    <p>Verf√ºgbare Karten nach Topic</p>
  </mat-card-header>
  <mat-progress-bar mode="query" *ngIf="this.loadingState === 'loading'"></mat-progress-bar>
  <mat-accordion *ngIf="this.loadingState === 'loaded'" class="map-catalogue__content" multi="true" displayMode="flat">
    <ng-container *ngFor="let topic of topics">
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <p>{{ topic.title }}</p>
        </mat-expansion-panel-header>
        <!-- Expansion panel content -->
        <ng-template matExpansionPanelContent>
          <ng-container *ngFor="let map of topic.maps">
            <mat-expansion-panel hideToggle="true" #mapExpansionPanel>
              <mat-expansion-panel-header (click)="mapExpansionPanel.toggle()" class="map__header">
                <p class="single-line-text last-left-aligned-element" matTooltip="{{ map.title }}">{{ map.title }}</p>
                <button mat-icon-button (click)="addActiveMap(map)"><mat-icon>playlist_add</mat-icon></button>
                <button mat-icon-button *ngIf="!mapExpansionPanel.expanded" (click)="mapExpansionPanel.open()">
                  <mat-icon>chevron_right</mat-icon>
                </button>
                <button mat-icon-button *ngIf="mapExpansionPanel.expanded" (click)="mapExpansionPanel.close()">
                  <mat-icon>expand_more</mat-icon>
                </button>
              </mat-expansion-panel-header>
              <!-- Expansion panel content -->
              <ng-template matExpansionPanelContent>
                <ng-container *ngFor="let layer of map.layers">
                  <div class="horizontal-stacked">
                    <mat-icon class="layer-icon">layers</mat-icon>
                    <p class="layer-text single-line-text last-left-aligned-element" matTooltip="{{ layer.title }}">{{ layer.title }}</p>
                    <button mat-icon-button (click)="addActiveLayer(map, layer)"><mat-icon>playlist_add</mat-icon></button>
                  </div>
                </ng-container>
              </ng-template>
            </mat-expansion-panel>
          </ng-container>
        </ng-template>
      </mat-expansion-panel>
    </ng-container>
  </mat-accordion>
</mat-card>
